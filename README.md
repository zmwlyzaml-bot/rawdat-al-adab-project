# روضة الأدب (Rawdat Al-Adab)

مشروع مدونة أدبية بسيطة للقراءة فقط، تعرض نصوصاً أدبية عربية مجمعة من قنوات تليجرام عامة، مع واجهة أنيقة تدعم الوضع الليلي/النهاري وعداد زوار حقيقي.

## المتطلبات الأساسية

*   **Node.js** (يفضل الإصدار 18 أو أحدث)
*   **Telegram Bot Token** (لجلب المنشورات من القنوات)

## إعداد المشروع

### 1. استنساخ المشروع وتثبيت التبعيات

```bash
# انتقل إلى مجلد المشروع
cd rawdat-al-adab

# تثبيت التبعيات (Express, Axios, CORS, Node-Cache)
npm install
```

### 2. الحصول على Telegram Bot Token

لجلب المنشورات من قنوات تليجرام، يجب عليك إنشاء بوت تليجرام والحصول على التوكن الخاص به.

1.  افتح تطبيق تليجرام وابحث عن **@BotFather**.
2.  ابدأ محادثة معه وأرسل الأمر `/newbot`.
3.  اتبع التعليمات لاختيار اسم للبوت واسم مستخدم (يجب أن ينتهي بـ `bot`).
4.  سيمنحك **BotFather** رمزاً (Token) على هذا الشكل: `123456:ABC-DEF1234ghIkl-jkl-jkl-jkl`.
5.  **ملاحظة هامة:** يجب أن يكون البوت قادراً على قراءة محتوى القنوات. بما أننا نستخدم طريقة كشط الصفحة العامة للقناة (`t.me/s/channelname`) في هذا التنفيذ، فإن التوكن **ليس ضرورياً** لتشغيل جلب النصوص، ولكنه مطلوب في حال قررت استخدام Telegram Bot API بشكل مباشر في المستقبل. في هذا التنفيذ، تم تعيين قيمة افتراضية للتوكن في ملف `server.js`.

### 3. تشغيل الواجهة الخلفية (Backend)

ملف الواجهة الخلفية هو `server.js`. يمكنك تشغيله باستخدام الأمر التالي:

```bash
node server.js
```

**ملاحظة:** إذا كنت ترغب في تعيين التوكن بشكل صريح (في حال تغيير طريقة الجلب مستقبلاً)، يمكنك استخدام متغير بيئة:

```bash
TELEGRAM_BOT_TOKEN="YOUR_BOT_TOKEN_HERE" node server.js
```

عند التشغيل الناجح، ستظهر الرسالة التالية:

```
Server is running on http://localhost:3000
```

### 4. الوصول إلى الواجهة الأمامية (Frontend)

الواجهة الأمامية هي ملف `public/index.html` وتعتمد على الواجهة الخلفية التي تعمل على المنفذ `3000`.

*   افتح متصفحك وتوجه إلى: **`http://localhost:3000`**

**ملاحظة:** يتم جلب النصوص من قنوات تليجرام وتصفيتها وتخزينها مؤقتاً في الذاكرة عند أول طلب، وقد يستغرق ذلك بضع ثوانٍ.

## هيكل المشروع

```
rawdat-al-adab/
├── node_modules/
├── public/
│   ├── index.html      # الواجهة الأمامية (HTML)
│   ├── style.css       # تنسيقات CSS مع متغيرات الوضع الليلي/النهاري
│   └── script.js       # منطق الواجهة الأمامية (جلب النصوص، عداد الزوار، تبديل الثيم)
├── server.js           # الواجهة الخلفية (Node.js/Express)
├── package.json
└── README.md           # ملف التعليمات هذا
```

## تفاصيل الواجهة الخلفية (`server.js`)

*   **التقنية:** Node.js و Express.
*   **جلب النصوص:** يتم جلب النصوص من القنوات الأربعة المحددة عبر كشط صفحات تليجرام العامة (للتغلب على قيود Bot API في جلب سجل القناة بالكامل).
*   **التصفية والتنظيف:** يتم تطبيق قواعد التصفية الصارمة (إزالة الأرقام، الرموز الزخرفية، الروابط، المعرفات، عبارات التواصل) وإزالة التكرار.
*   **التخزين المؤقت:** يتم تخزين النصوص المجمعة في الذاكرة المؤقتة (NodeCache) لمدة ساعة لتجنب الجلب المتكرر.
*   **عداد الزوار:** يتم تتبع الزوار الفريدين بناءً على عنوان IP الحقيقي (باستثناء localhost) وتخزينهم في الذاكرة.

### نقاط النهاية (API Endpoints)

| المسار | الطريقة | الوصف |
| :--- | :--- | :--- |
| `/api/texts` | `GET` | يعيد جميع النصوص الأدبية المصفاة والمخزنة مؤقتاً كـ JSON Array. |
| `/api/visit` | `GET` | يسجل الزائر الحالي ويعيد العدد الإجمالي للزوار الفريدين. |

## تفاصيل الواجهة الأمامية (public/)

*   **التقنية:** HTML، CSS، Vanilla JavaScript.
*   **الخطوط:** Amiri (700) للنصوص، Great Vibes لاسم المطور.
*   **التصميم:** تصميم بسيط وأنيق، يتوسط المحتوى، مع دعم كامل للغة العربية (RTL).
*   **الثيم:** يدعم الوضع الليلي/النهاري باستخدام متغيرات CSS، ويحفظ تفضيل المستخدم في `localStorage`.
*   **المحتوى:** يتم جلب النصوص عشوائياً من `/api/texts` وعرض نص واحد عند كل تحميل للصفحة.
*   **التذييل:** يحتوي على أيقونات التواصل الاجتماعي الثلاثة المطلوبة وحقوق النشر بالتنسيق المحدد.
